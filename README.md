# Лабораторная работа №4. Симуляция казино с гусями

## Описание проекта

Это симуляции казино, в котором участвуют игроки и гуси. На каждом шаге симуляции происходит случайное событие: игроки делают ставки, выигрывают или проигрывают, боевые гуси атакуют игроков, кричащие гуси устраивают панику, а обычные гуси воруют деньги. Все события логируются в консоль.

## Структура проекта

```
src/
├── main.py              # Точка входа в приложение
├── simulation.py        # Функция запуска симуляции
├── casino.py            # Класс Casino с логикой казино
├── command.py           # Парсинг команд для CLI
├── exceptions.py        # Кастомные исключения
├── collections/         # Пользовательские коллекции
│   ├── player_collection.py    # Списковая коллекция игроков
│   ├── goose_collection.py     # Списковая коллекция гусей
│   └── balance_dict.py         # Словарная коллекция балансов
└── entities/            # Сущности
    ├── player.py        # Класс игрока
    ├── goose.py         # Базовый класс гуся и подклассы
    └── chip.py          # Класс фишки казино

tests/                   # Unit-тесты
├── test_casino.py       # Тесты для Casino
├── test_collections.py  # Тесты для коллекций
└── test_entities.py     # Тесты для сущностей
```

## Запуск симуляции

```bash
python src/main.py
```
Введите команду: run 20 42

где 20 - количество шагов, 42 - seed (опционально)


### Запуск тестов

```bash
pytest --cov
```

## Основные компоненты

### Пользовательские коллекции

**PlayerCollection** - списковая коллекция игроков:
- Поддерживает индексацию, срезы, итерацию
- Методы добавления и удаления элементов
- Проверка индексов

**GooseCollection** - списковая коллекция гусей:
- Аналогично PlayerCollection
- Дополнительно поддерживает операцию сложения (объединение коллекций)
- Проверка наличия элемента через оператор in

**CasinoBalance** - словарная коллекция балансов:
- Хранит балансы игроков по имени
- Автоматически логирует все изменения балансов
- Поддерживает стандартные операции словаря

### Сущности

**Player** - игрок казино:
- Имеет имя и баланс
- Может изменять баланс через метод change_balance

**Goose** - базовый класс гуся:
- Имеет имя и громкость крика (honk_volume)
- Метод honk() для обычного крика

**WarGoose** - боевой гусь:
- Наследуется от Goose
- Метод attack() атакует игрока и отнимает деньги

**HonkGoose** - кричащий гусь:
- Наследуется от Goose
- Метод special_honk() влияет на балансы всех игроков

**Chip** - фишка казино:
- Имеет номинал (amount)
- Поддерживает операцию сложения через магический метод __add__

### События симуляции

На каждом шаге случайно выбирается одно из событий:

1. **event_player_bet** - игрок делает ставку (теряет деньги)
2. **event_player_win** - игрок выигрывает (получает деньги)
3. **event_goose_attack** - боевой гусь атакует игрока
4. **event_goose_honk** - кричащий гусь устраивает панику (все игроки теряют деньги)
5. **event_steal** - гусь ворует деньги у игрока

### Кастомные исключения

Проект использует иерархию кастомных исключений для обработки ошибок:

- **PlayerNotFoundError** - игрок не найден в коллекции
- **GooseNotFoundError** - гусь не найден в коллекции
- **IndexOutOfRangeError** - индекс вне допустимого диапазона
- **InsufficientPlayersError** - недостаточно игроков для операции
- **InsufficientGeeseError** - недостаточно гусей для операции
- **InsufficientWarGeeseError** - нет боевых гусей
- **InsufficientHonkGeeseError** - нет кричащих гусей
- **PlayerAlreadyExistsError** - игрок с таким именем уже зарегистрирован
- **ChipTypeError** - ошибка типа при работе с фишками

При одинаковом seed симуляция будет воспроизводить одинаковую последовательность событий.

## Особенности реализации

- Все коллекции реализованы через композицию (внутри используется стандартный list или dict)
- Наследование используется для создания специальных типов гусей
- Магические методы реализованы для удобной работы с объектами
- Симуляция использует модуль random с поддержкой seed для воспроизводимости
- Все события логируются в консоль
